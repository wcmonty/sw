ti = @(n, i) ((i-1)/(n-1))

ti = 

    @(n,i)((i-1)/(n-1))

n = 8;
g = zeros(8, 1);
g(1) = exp(3);
g(n) = 1;
A = zeros(n, n);
A(1, 1) = 1;
for i = 1:n
A(n, i) = 1;
end
f = @(n, i, j) ((j-1)*(j-2)*ti(n, i)^(j-3) + (2*(j-1)*ti(n, i)^(j-2)) - (3 * ti(n, i)^(j - 1)));
for i = 2:n-1
for j = 1:n
A(i, j) = f(n,i, j);
end
end
A

A =

    1.0000         0         0         0         0         0         0         0
   -3.0000    1.5714    2.5102    0.9708    0.2670    0.0623    0.0132    0.0026
   -3.0000    1.1429    2.8980    2.1341    1.1462    0.5274    0.2211    0.0871
   -3.0000    0.7143    3.1633    3.4373    2.7326    1.8683    1.1670    0.6860
   -3.0000    0.2857    3.3061    4.8280    5.0912    4.6152    3.8253    2.9867
   -3.0000   -0.1429    3.3265    6.2536    8.2570    9.3339    9.6420    9.3840
   -3.0000   -0.5714    3.2245    7.6618   12.2349   16.6045   20.5555   23.9641
    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000

c = inv(A) * g;
t = 0:.01:1

t =

  Columns 1 through 14

         0    0.0100    0.0200    0.0300    0.0400    0.0500    0.0600    0.0700    0.0800    0.0900    0.1000    0.1100    0.1200    0.1300

  Columns 15 through 28

    0.1400    0.1500    0.1600    0.1700    0.1800    0.1900    0.2000    0.2100    0.2200    0.2300    0.2400    0.2500    0.2600    0.2700

  Columns 29 through 42

    0.2800    0.2900    0.3000    0.3100    0.3200    0.3300    0.3400    0.3500    0.3600    0.3700    0.3800    0.3900    0.4000    0.4100

  Columns 43 through 56

    0.4200    0.4300    0.4400    0.4500    0.4600    0.4700    0.4800    0.4900    0.5000    0.5100    0.5200    0.5300    0.5400    0.5500

  Columns 57 through 70

    0.5600    0.5700    0.5800    0.5900    0.6000    0.6100    0.6200    0.6300    0.6400    0.6500    0.6600    0.6700    0.6800    0.6900

  Columns 71 through 84

    0.7000    0.7100    0.7200    0.7300    0.7400    0.7500    0.7600    0.7700    0.7800    0.7900    0.8000    0.8100    0.8200    0.8300

  Columns 85 through 98

    0.8400    0.8500    0.8600    0.8700    0.8800    0.8900    0.9000    0.9100    0.9200    0.9300    0.9400    0.9500    0.9600    0.9700

  Columns 99 through 101

    0.9800    0.9900    1.0000

fy = @(t) (exp(3 - 3*t));
fy = @(t) (exp(3 - 3.*t));
y = fy(t);
plot(t, y);
w8 = nest(n-1, c, t)

w8 =

  Columns 1 through 14

   20.0855   19.4920   18.9160   18.3571   17.8146   17.2881   16.7772   16.2814   15.8002   15.3332   14.8801   14.4403   14.0135   13.5994

  Columns 15 through 28

   13.1975   12.8074   12.4289   12.0616   11.7051   11.3592   11.0235   10.6977   10.3815   10.0747    9.7770    9.4880    9.2076    8.9355

  Columns 29 through 42

    8.6714    8.4151    8.1664    7.9251    7.6909    7.4636    7.2430    7.0289    6.8212    6.6196    6.4240    6.2341    6.0499    5.8711

  Columns 43 through 56

    5.6976    5.5292    5.3658    5.2072    5.0533    4.9040    4.7591    4.6184    4.4819    4.3495    4.2209    4.0962    3.9751    3.8577

  Columns 57 through 70

    3.7437    3.6330    3.5257    3.4215    3.3204    3.2222    3.1270    3.0346    2.9449    2.8579    2.7735    2.6915    2.6120    2.5348

  Columns 71 through 84

    2.4599    2.3872    2.3166    2.2482    2.1817    2.1173    2.0547    1.9940    1.9351    1.8779    1.8224    1.7685    1.7163    1.6656

  Columns 85 through 98

    1.6164    1.5686    1.5223    1.4773    1.4336    1.3913    1.3502    1.3103    1.2716    1.2340    1.1975    1.1621    1.1277    1.0944

  Columns 99 through 101

    1.0620    1.0305    1.0000

plot(t, w8, 'x', t, y, '-')
err8 = y - w8;
n = 16;
g = zeros(n, 1);
g(1) = exp(3);
g(n) = 1;
A = zeros(n,n);
A(1) = 1;
for i = 1:n
A(n, i) = 1;
end
A

A =

     1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
     1     1     1     1     1     1     1     1     1     1     1     1     1     1     1     1

for i = 2:n-1
for j = 1:n
A(i, j) = f(n, i, j);
end
end
A

A =

  Columns 1 through 14

    1.0000         0         0         0         0         0         0         0         0         0         0         0         0         0
   -3.0000    1.8000    2.2533    0.4258    0.0556    0.0061    0.0006    0.0001    0.0000    0.0000    0.0000    0.0000    0.0000    0.0000
   -3.0000    1.6000    2.4800    0.8996    0.2313    0.0504    0.0100    0.0018    0.0003    0.0001    0.0000    0.0000    0.0000    0.0000
   -3.0000    1.4000    2.6800    1.4160    0.5392    0.1750    0.0516    0.0143    0.0038    0.0010    0.0002    0.0001    0.0000    0.0000
   -3.0000    1.2000    2.8533    1.9698    0.9899    0.4258    0.1668    0.0614    0.0216    0.0073    0.0024    0.0008    0.0003    0.0001
   -3.0000    1.0000    3.0000    2.5556    1.5926    0.8519    0.4156    0.1907    0.0837    0.0355    0.0147    0.0059    0.0024    0.0009
   -3.0000    0.8000    3.1200    3.1680    2.3552    1.5053    0.8786    0.4825    0.2536    0.1290    0.0639    0.0310    0.0148    0.0070
   -3.0000    0.6000    3.2133    3.8018    3.2841    2.4405    1.6574    1.0597    0.6488    0.3844    0.2220    0.1256    0.0698    0.0383
   -3.0000    0.4000    3.2800    4.4516    4.3842    3.7137    2.8760    2.0977    1.4655    0.9911    0.6534    0.4220    0.2680    0.1678
   -3.0000    0.2000    3.3200    5.1120    5.6592    5.3827    4.6812    3.8351    3.0102    2.2876    1.6951    1.2307    0.8787    0.6186
   -3.0000         0    3.3333    5.7778    7.1111    7.5062    7.2428    6.5844    5.7357    4.8383    3.9799    3.2082    2.5434    1.9885
   -3.0000   -0.2000    3.3200    6.4436    8.7407   10.1432   10.7546   10.7427   10.2835    9.5334    8.6193    7.6375    6.6564    5.7213
   -3.0000   -0.4000    3.2800    7.1040   10.5472   13.3530   15.4337   16.8034   17.5322   17.7167   17.4617   16.8685   16.0288   15.0221
   -3.0000   -0.6000    3.2133    7.7538   12.5285   17.1941   21.5211   25.3665   28.6513   31.3438   33.4454   34.9811   35.9908   36.5238
   -3.0000   -0.8000    3.1200    8.3876   14.6811   21.7243   29.2809   37.1498   45.1615   53.1738   61.0687   68.7495   76.1380   83.1721
    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000

  Columns 15 through 16

         0         0
    0.0000    0.0000
    0.0000    0.0000
    0.0000    0.0000
    0.0000    0.0000
    0.0004    0.0001
    0.0032    0.0015
    0.0207    0.0111
    0.1039    0.0636
    0.4304    0.2964
    1.5363    1.1749
    4.8600    4.0867
   13.9143   12.7587
   36.6339   36.3766
   89.8039   95.9975
    1.0000    1.0000

c = inv(A) * g;
w16 = nest(n-1, c, t);
err16 = y - w16;
plot(t, w16, '+', t, y, '-')
semilog(t, err8, '+', t, err16, 'O')
{Undefined function 'semilog' for input arguments of type 'double'.
} 
semilogx(t, err8, '+', t, err16, 'O')
diary off
