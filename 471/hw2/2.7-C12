diary off
f = @(x) [(x(1) - 1)^2 + (x(2))^2 + (x(3) - 1)^2 - 8; (x(1))^2 + (x(2) - 2)^2 + (x(3) - 2)^2 - 2; (x(1))^2 + (x(2) - 3)^2 + (x(3) - 3)^2 - 2]

f = 

    @(x)[(x(1)-1)^2+(x(2))^2+(x(3)-1)^2-8;(x(1))^2+(x(2)-2)^2+(x(3)-2)^2-2;(x(1))^2+(x(2)-3)^2+(x(3)-3)^2-2]

for i = 1:50
x = broyden2 (f, [1;1;1], i);
fprintf('%.10f %.10f %.10f\n', x(1), x(2), x(3));
end
8.0000000000 0.0000000000 -6.0000000000
27.1612903226 27.6774193548 26.3612903226
-2.4612532550 0.3254566867 0.9314333207
-4.9557132194 2.6705640418 0.9325002488
56.0068159615 -128.4132206920 127.3634319585
-0.3094576715 5.1729920967 -0.1459788369
2.3740383406 6.1292314220 -1.0949164742
7.0703799676 8.0347566882 -3.0340396246
8.1820244536 9.0736128036 -4.0746839969
3.6200450300 4.6409631663 0.3593323513
2.7090864164 3.7139359872 1.2861130790
2.0960743406 3.0954643948 1.9045285186
1.7277316950 2.7273381818 2.2726579680
1.4425695847 2.4425467871 2.5574530111
1.2676077704 2.2676285768 2.7323716244
1.1639378097 2.1639425443 2.8360575010
1.1021472863 2.1021467943 2.8978532010
1.0635429702 2.0635425888 2.9364574076
1.0392549250 2.0392548934 2.9607451063
1.0241871055 2.0241871243 2.9758128759
1.0149320018 2.0149320069 2.9850679932
1.0092361241 2.0092361237 2.9907638762
1.0057130105 2.0057130102 2.9942869898
1.0035308373 2.0035308373 2.9964691627
1.0021813977 2.0021813977 2.9978186023
1.0013479695 2.0013479695 2.9986520305
1.0008331638 2.0008331638 2.9991668362
1.0005149772 2.0005149772 2.9994850228
1.0003182756 2.0003182756 2.9996817244
1.0001966970 2.0001966970 2.9998033030
1.0001215628 2.0001215628 2.9998784372
1.0000751309 2.0000751309 2.9999248691
1.0000464334 2.0000464334 2.9999535666
1.0000286982 2.0000286982 2.9999713018
1.0000177364 2.0000177364 2.9999822636
1.0000109608 2.0000109608 2.9999890392
1.0000067758 2.0000067758 2.9999932242
1.0000041893 2.0000041893 2.9999958107
1.0000025799 2.0000025799 2.9999974201
1.0000016056 2.0000016056 2.9999983944
1.0000010019 2.0000010019 2.9999989981
1.0000005880 2.0000005880 2.9999994120
1.0000003797 2.0000003797 2.9999996203
1.0000002322 2.0000002322 2.9999997678
1.0000001821 2.0000001821 2.9999998179
0.9999996558 1.9999996558 3.0000003442
1.0000005562 2.0000005562 2.9999994438
0.9999993660 1.9999993660 3.0000006340
1.0000058961 2.0000058961 2.9999941039
0.9999992896 1.9999992896 3.0000007104
diary off
