f = @(x) exp(x^2)

f = 

    @(x)exp(x^2)

romberg(f, 0, 1, 20, .000000005)

ans =

   1.859140914229523                   0                   0                   0                   0                   0
   1.571583165458632   1.475730582535002                   0                   0                   0                   0
   1.490678861698856   1.463710760445597   1.462909438972970                   0                   0                   0
   1.469712276429665   1.462723414673269   1.462657591621780   1.462653594044777                   0                   0
   1.464420310149482   1.462656321389421   1.462651848503831   1.462651757343228   1.462651750140477                   0
   1.463094102606428   1.462652033425411   1.462651747561143   1.462651745958878   1.462651745914234   1.462651745910103

f = @(x) sinx(x^2)

f = 

    @(x)sinx(x^2)

romberg(f, 0, sqrt(pi), .000000005)
{Undefined function 'sinx' for input arguments of type 'double'.

Error in <a href="matlab:helpUtils.errorDocCallback('@(x)sinx(x^2)', '', 0)" style="font-weight:bold">@(x)sinx(x^2)</a>


Error in <a href="matlab:helpUtils.errorDocCallback('romberg', '/home/wcmonty/Projects/471/romberg.m', 9)" style="font-weight:bold">romberg</a> (<a href="matlab: opentoline('/home/wcmonty/Projects/471/romberg.m',9,0)">line 9</a>)
r(1,1) = (b-a) * (f(a) + f(b))/2;
} 
f = @(x) sin(x^2)

f = 

    @(x)sin(x^2)

romberg(f, 0, sqrt(pi), .000000005)

ans =

     5.020953118295576e-16

romberg(f, 0, sqrt(pi), .000000005)

ans =

     5.020953118295576e-16

romberg(f, 0, sqrt(pi), 20, .000000005)

ans =

  Columns 1 through 6

   0.000000000000001                   0                   0                   0                   0                   0
   0.626657068657750   0.835542758210334                   0                   0                   0                   0
   0.834374844252384   0.903614102783929   0.908152192422168                   0                   0                   0
   0.880180237113810   0.895448701400952   0.894904341308753   0.894694057957747                   0                   0
   0.891196917396649   0.894869144157595   0.894830507008038   0.894829335035011   0.894829865533353                   0
   0.893924583421267   0.894833805429473   0.894831449514264   0.894831464474681   0.894831472825424   0.894831474396580
   0.894604857236032   0.894831615174288   0.894831469157275   0.894831469469069   0.894831469488655   0.894831469485393
   0.894774823247713   0.894831478584940   0.894831469478984   0.894831469484090   0.894831469484149   0.894831469484145
   0.894817308351580   0.894831470052869   0.894831469484064   0.894831469484145   0.894831469484145   0.894831469484145
   0.894827929227662   0.894831469519689   0.894831469484144   0.894831469484145   0.894831469484145   0.894831469484145
   0.894830584421690   0.894831469486366   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831248218636   0.894831469484284   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831414167774   0.894831469484154   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831455655053   0.894831469484146   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831466026873   0.894831469484146   0.894831469484146   0.894831469484146   0.894831469484146   0.894831469484146
   0.894831468619829   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147
   0.894831469268066   0.894831469484146   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831469430126   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147
   0.894831469470634   0.894831469484136   0.894831469484136   0.894831469484136   0.894831469484135   0.894831469484135
   0.894831469480768   0.894831469484146   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147

  Columns 7 through 12

                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
   0.894831469484194                   0                   0                   0                   0                   0
   0.894831469484144   0.894831469484144                   0                   0                   0                   0
   0.894831469484145   0.894831469484145   0.894831469484145                   0                   0                   0
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145                   0                   0
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145                   0
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831469484146   0.894831469484146   0.894831469484146   0.894831469484146   0.894831469484146   0.894831469484146
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147
   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147

  Columns 13 through 18

                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
                   0                   0                   0                   0                   0                   0
   0.894831469484145                   0                   0                   0                   0                   0
   0.894831469484145   0.894831469484145                   0                   0                   0                   0
   0.894831469484146   0.894831469484146   0.894831469484146                   0                   0                   0
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147                   0                   0
   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145   0.894831469484145                   0
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147
   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135   0.894831469484135
   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147   0.894831469484147

  Columns 19 through 20

                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
   0.894831469484135                   0
   0.894831469484147   0.894831469484147

romberg(f, 0, sqrt(pi), 20, .000000005)

ans =

  Columns 1 through 6

   0.000000000000001                   0                   0                   0                   0                   0
   0.626657068657750   0.835542758210334                   0                   0                   0                   0
   0.834374844252384   0.903614102783929   0.908152192422168                   0                   0                   0
   0.880180237113810   0.895448701400952   0.894904341308753   0.894694057957747                   0                   0
   0.891196917396649   0.894869144157595   0.894830507008038   0.894829335035011   0.894829865533353                   0
   0.893924583421267   0.894833805429473   0.894831449514264   0.894831464474681   0.894831472825424   0.894831474396580
   0.894604857236032   0.894831615174288   0.894831469157275   0.894831469469069   0.894831469488655   0.894831469485393

  Column 7

                   0
                   0
                   0
                   0
                   0
                   0
   0.894831469484194

f = @(x) exp(cos(x));
romberg(f, 0, pi, 20, .000000005)

ans =

  Columns 1 through 6

   4.847730786232245                   0                   0                   0                   0                   0
   3.994661719911019   3.710305364470610                   0                   0                   0                   0
   3.977463886350889   3.971731275164179   3.989159669210417                   0                   0                   0
   3.977463260506423   3.977463051891601   3.977845170340095   3.977665575119932                   0                   0
   3.977463260506423   3.977463260506423   3.977463274414078   3.977457212573983   3.977456395465960                   0
   3.977463260506422   3.977463260506422   3.977463260506422   3.977463260285665   3.977463284002182   3.977463290735844
   3.977463260506422   3.977463260506422   3.977463260506422   3.977463260506422   3.977463260507287   3.977463260484321
   3.977463260506423   3.977463260506423   3.977463260506424   3.977463260506424   3.977463260506424   3.977463260506423

  Columns 7 through 8

                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
                   0                   0
   3.977463260476934                   0
   3.977463260506428   3.977463260506430

f = @(x) log(x^2 + 1)

f = 

    @(x)log(x^2+1)

romberg(f, 0, 1, 20, .000000005)

ans =

   0.346573590279973                   0                   0                   0                   0                   0
   0.284858570797091   0.264286897636131                   0                   0                   0                   0
   0.269157216509759   0.263923431747315   0.263899200688061                   0                   0                   0
   0.265245929011107   0.263942166511557   0.263943415495839   0.263944117318185                   0                   0
   0.264269049369094   0.263943422821757   0.263943506575770   0.263943508021483   0.263943505632084                   0
   0.264024888887538   0.263943502060353   0.263943507342926   0.263943507355103   0.263943507352490   0.263943507354171

diary off
