[a, b] = sparsesetup44c2(1000);
spy(a)
tol = 1e-12; maxit = 50;
[x0,fl0,rr0,it0,rv0] = gmres(a,b,[],tol,maxit);
semilogy(0:maxit,rv0/norm(b),'-o');
xlabel('Iteration number');
ylabel('Relative residual');
semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv0/norm(b) * 2,'-x');
Jacobi = diag(diag(a));
[x1,fl1,rr1,it1,rv1] = gmres(a,b,[],tol,maxit, Jacobi);
semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv1/norm(b),'-x');
{Error using <a href="matlab:helpUtils.errorDocCallback('semilogy')" style="font-weight:bold">semilogy</a>
Vectors must be the same lengths.
} 
rv1

rv1 =

   32.2439
    3.0746
    0.3483
    0.0341
    0.0033
    0.0009
    0.0001
    0.0000
    0.0000
    0.0000
    0.0000
    0.0000
    0.0000
    0.0000

rv0

rv0 =

   1.0e+04 *

    1.8336
    0.4583
    0.1833
    0.0916
    0.0524
    0.0327
    0.0218
    0.0153
    0.0111
    0.0083
    0.0064
    0.0050
    0.0040
    0.0032
    0.0027
    0.0022
    0.0018
    0.0016
    0.0013
    0.0011
    0.0010
    0.0008
    0.0007
    0.0006
    0.0006
    0.0005
    0.0004
    0.0004
    0.0004
    0.0003
    0.0003
    0.0003
    0.0002
    0.0002
    0.0002
    0.0002
    0.0002
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001
    0.0001

format long
rv1

rv1 =

  32.243919590221836
   3.074602325317044
   0.348275187636164
   0.034072484258990
   0.003282861376561
   0.000927855801527
   0.000115745451260
   0.000023533434029
   0.000001339333379
   0.000000132494054
   0.000000007646449
   0.000000000841213
   0.000000000034975
   0.000000000001775

rv0

rv0 =

   1.0e+04 *

   1.833615533583854
   0.458267007038257
   0.183275528584043
   0.091632590014782
   0.052354008538765
   0.032716510432944
   0.021805049604445
   0.015257593213344
   0.011089527931394
   0.008309723706892
   0.006383886552540
   0.005007173417055
   0.003996451669830
   0.003237487854460
   0.002656271314857
   0.002203580291936
   0.001845689137439
   0.001559052312419
   0.001326819948295
   0.001136766718280
   0.000979829380879
   0.000849219649955
   0.000739752946056
   0.000647439086090
   0.000569151282210
   0.000502425809192
   0.000445288852910
   0.000396153723958
   0.000353725586865
   0.000316946514164
   0.000284940641523
   0.000256983597744
   0.000232469482446
   0.000210893129116
   0.000191829284190
   0.000174921808295
   0.000159869945694
   0.000146421402300
   0.000134362895500
   0.000123515504016
   0.000113727917876
   0.000104873182598
   0.000096843742247
   0.000089549091006
   0.000082912066789
   0.000076867148004
   0.000071357678007
   0.000066334666461
   0.000061754761547
   0.000057579481263
   0.000053773809397

rv0.length
{Attempt to reference field of non-structure array.
} 
length(rv0)

ans =

    51

padarray(r1, 51)
{Undefined function or variable 'r1'.
} 
padarray(rv1, 51)

ans =

                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
  32.243919590221836
   3.074602325317044
   0.348275187636164
   0.034072484258990
   0.003282861376561
   0.000927855801527
   0.000115745451260
   0.000023533434029
   0.000001339333379
   0.000000132494054
   0.000000007646449
   0.000000000841213
   0.000000000034975
   0.000000000001775
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0

rv1

rv1 =

  32.243919590221836
   3.074602325317044
   0.348275187636164
   0.034072484258990
   0.003282861376561
   0.000927855801527
   0.000115745451260
   0.000023533434029
   0.000001339333379
   0.000000132494054
   0.000000007646449
   0.000000000841213
   0.000000000034975
   0.000000000001775

padarray(rv1, 51, 0, 'post')

ans =

  32.243919590221836
   3.074602325317044
   0.348275187636164
   0.034072484258990
   0.003282861376561
   0.000927855801527
   0.000115745451260
   0.000023533434029
   0.000001339333379
   0.000000132494054
   0.000000007646449
   0.000000000841213
   0.000000000034975
   0.000000000001775
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0

rv1 = padarray(rv1, 51, 0, 'post');
semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv1/norm(b),'-x');
{Error using <a href="matlab:helpUtils.errorDocCallback('semilogy')" style="font-weight:bold">semilogy</a>
Vectors must be the same lengths.
} 
length(rv1)

ans =

    65

rv1 = rv1(1:51)

rv1 =

  32.243919590221836
   3.074602325317044
   0.348275187636164
   0.034072484258990
   0.003282861376561
   0.000927855801527
   0.000115745451260
   0.000023533434029
   0.000001339333379
   0.000000132494054
   0.000000007646449
   0.000000000841213
   0.000000000034975
   0.000000000001775
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0

length(rv1)

ans =

    51

semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv1/norm(b),'-x');
GaussSeidel = (Jacobi + tril(a)) * inv(Jacobi) * (Jacobi + triu(a));
[x2,fl2,rr2,it2,rv2] = gmres(a,b,[],tol,maxit, GaussSeidel);
semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv1/norm(b),'-x', 0:maxit,rv2/norm(b),'-+');
{Error using <a href="matlab:helpUtils.errorDocCallback('semilogy')" style="font-weight:bold">semilogy</a>
Vectors must be the same lengths.
} 
length(rv2)

ans =

    11

padarray(rv2, 40, 0, 'post');
length(rv2)

ans =

    11

rv2 = padarray(rv2, 40, 0, 'post');
length(rv2)

ans =

    51

semilogy(0:maxit,rv0/norm(b),'-o', 0:maxit,rv1/norm(b),'-x', 0:maxit,rv2/norm(b),'-+');
diary off
